-- Print Company Code, Founder, Total Number of LM, SM, M and E's
-- https://www.hackerrank.com/challenges/the-company/problem

SELECT DISTINCT COMPANY_CODE
,FOUNDER
,COUNT(DISTINCT LEAD_MANAGER_CODE)
,COUNT(DISTINCT SENIOR_MANAGER_CODE)
,COUNT(DISTINCT MANAGER_CODE)
,COUNT(DISTINCT EMPLOYEE_CODE)
FROM
(SELECT A.COMPANY_CODE, FOUNDER, B.LEAD_MANAGER_CODE, C.SENIOR_MANAGER_CODE,
D.MANAGER_CODE, E.EMPLOYEE_CODE
FROM COMPANY A
LEFT JOIN LEAD_MANAGER B
ON A.COMPANY_CODE = B.COMPANY_CODE
LEFT JOIN SENIOR_MANAGER C 
ON A.COMPANY_CODE = C.COMPANY_CODE
LEFT JOIN MANAGER D
ON A.COMPANY_CODE = D.COMPANY_CODE
LEFT JOIN EMPLOYEE E
ON A.COMPANY_CODE = E.COMPANY_CODE
)TM
GROUP BY COMPANY_CODE, FOUNDER
ORDER BY COMPANY_CODE
